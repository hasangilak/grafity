# Grafity Architecture - ASCII Art Diagrams

## High-Level System Architecture

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                                  USER INTERFACE LAYER                            │
├──────────────────┬────────────────────┬────────────────────┬──────────────────┤
│  Visual Graph UI │  Claude Code CLI   │   IDE Plugins      │  Web Dashboard   │
│    (React/D3)    │  $ claude analyze  │  (VS Code/JB)      │   (Browser)      │
└────────┬─────────┴──────────┬─────────┴──────────┬─────────┴──────────┬───────┘
         │                    │                     │                     │
         ▼                    ▼                     ▼                     ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              AI INTELLIGENCE LAYER                               │
├─────────────────────────────────────────────────────────────────────────────────┤
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐       │
│  │ Claude Code  │  │   Pattern    │  │     Code     │  │  Semantic    │       │
│  │   Assistant  │◄─►│ Recognition  │◄─►│  Generation  │◄─►│ Understanding│       │
│  └──────────────┘  └──────────────┘  └──────────────┘  └──────────────┘       │
└─────────────────────────────────┬───────────────────────────────────────────────┘
                                  │
                                  ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                            GRAPH PROCESSING ENGINE                               │
├─────────────────────────────────────────────────────────────────────────────────┤
│                          ┌─────────────────┐                                    │
│   ┌──────────┐          │                 │          ┌──────────┐              │
│   │ Business │◄────────►│   GRAPH CORE    │◄────────►│   Code   │              │
│   │  Graph   │          │    ENGINE       │          │  Graph   │              │
│   └──────────┘          │                 │          └──────────┘              │
│        ▲                └────────┬────────┘                ▲                    │
│        │                         │                          │                    │
│        │    ┌──────────┐        │        ┌──────────┐     │                    │
│        └───►│ Document │◄───────┴───────►│   Chat   │◄────┘                    │
│             │  Graph   │                 │  Graph   │                           │
│             └──────────┘                 └──────────┘                           │
└─────────────────────────────────┬───────────────────────────────────────────────┘
                                  │
                                  ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                           MECHANICAL ANALYSIS LAYER                              │
├─────────────────────────────────────────────────────────────────────────────────┤
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐       │
│  │ Nx Project   │  │  TypeScript  │  │  Data Flow   │  │   Reverse    │       │
│  │    Graph     │  │  AST Parser  │  │   Analyzer   │  │  Engineering │       │
│  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘       │
│         │                  │                  │                  │               │
└─────────┼──────────────────┼──────────────────┼──────────────────┼──────────────┘
          │                  │                  │                  │
          ▼                  ▼                  ▼                  ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              DATA SOURCES                                        │
├──────────────┬────────────────┬─────────────────┬────────────────┬─────────────┤
│  Source Code │  Documentation │   Confluence    │ Conversations  │  Metadata   │
│   (TS/JS)    │    (MD/PDF)    │    (Wiki)       │   (History)    │   (JSON)    │
└──────────────┴────────────────┴─────────────────┴────────────────┴─────────────┘
```

## Graph-Based AI Chat vs Traditional Linear Chat

```
TRADITIONAL LINEAR CHAT                   GRAPH-BASED AI CHAT
═══════════════════════                   ═══════════════════════

┌─────────────┐                           ┌─────────────┐
│   User: Q1  │                           │  Chat Node  │───────┐
└──────┬──────┘                           │     Q1      │       │
       │                                  └──────┬──────┘       │
       ▼                                         │              ▼
┌─────────────┐                                  │        ┌──────────┐
│   AI: A1    │                           ┌──────▼──────┐ │  Code    │
└──────┬──────┘                           │  Chat Node  │ │Reference │
       │                                  │     A1      │ └────┬─────┘
       ▼                                  └──────┬──────┘      │
┌─────────────┐                                  │              │
│   User: Q2  │                           ┌──────▼──────┐      │
└──────┬──────┘                           │   Docs      │◄─────┘
       │                                  │   Node      │
       ▼                                  └──────┬──────┘
┌─────────────┐                                  │
│   AI: A2    │                           ┌──────▼──────┐
└─────────────┘                           │  Business   │
       │                                  │  Context    │
       ▼                                  └──────┬──────┘
    [LINEAR]                                     │
 [CONTEXT LOST]                           ┌──────▼──────┐
                                         │  Chat Node  │
                                         │     Q2      │
                                         └─────────────┘
                                               │
                                         [GRAPH PRESERVES]
                                         [ALL CONNECTIONS]
```

## Bi-Directional Knowledge Graph

```
                            ┌─────────────────────┐
                            │    BUSINESS IDEA    │
                            │   "Todo App with    │
                            │   task management"   │
                            └──────────┬──────────┘
                                      │
                        ┌─────────────┼─────────────┐
                        ▼             ▼             ▼
                ┌──────────┐  ┌──────────┐  ┌──────────┐
                │   User   │  │ Business │  │ Technical│
                │  Story   │  │ Feature  │  │  Spec    │
                └─────┬────┘  └─────┬────┘  └─────┬────┘
                      │             │             │
                      └─────────────┼─────────────┘
                                   │
                    ╔══════════════▼══════════════╗
                    ║      GRAPH ENGINE           ║
                    ║   ┌───────────────┐        ║
                    ║   │ Bi-directional│        ║
                    ║   │   Connector   │        ║
                    ║   └───────┬───────┘        ║
                    ╚═══════════┼═════════════════╝
                                │
                ┌───────────────┼───────────────┐
                ▼               ▼               ▼
        ┌──────────┐    ┌──────────┐    ┌──────────┐
        │Component │◄──►│ Function │◄──►│   Data   │
        │TodoList  │    │ addTodo  │    │  Model   │
        └──────────┘    └──────────┘    └──────────┘
                ▲               ▲               ▲
                └───────────────┼───────────────┘
                                │
                        ┌──────────┐
                        │Generated │
                        │   Code   │
                        └──────────┘
```

## Pipeline Flow: Mechanical Tools + AI

```
     SOURCE CODE                    MECHANICAL ANALYSIS                AI ENHANCEMENT
  ================              =======================            ==================

  ┌──────────────┐              ┌──────────────┐
  │  TypeScript  │─────────────►│  Nx Project  │
  │    Files     │              │    Graph     │
  └──────────────┘              └──────┬───────┘
                                       │
                                       ▼
                               ┌──────────────┐
  ┌──────────────┐            │   AST Tree   │
  │   React      │───────────►│   Parser     │
  │  Components  │            └──────┬───────┘
  └──────────────┘                   │
                                     ▼
                            ┌─────────────────┐      ┌─────────────────┐
                            │  Mechanical     │      │  Claude Code    │
                            │  Graph Data     │─────►│     CLI         │
                            │  (100% Accurate)│      │                 │
                            └─────────────────┘      └────────┬────────┘
                                                              │
                                                              ▼
                                                    ┌─────────────────┐
                                                    │   Semantic      │
                                                    │  Understanding  │
                                                    └────────┬────────┘
                                                             │
    ┌────────────────────────────────────────────────────────▼────────┐
    │                     UNIFIED KNOWLEDGE GRAPH                     │
    │  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐      │
    │  │Business  │  │   Code   │  │   Docs   │  │   Chat   │      │
    │  │ Context  │◄►│  Nodes   │◄►│  Nodes   │◄►│  Nodes   │      │
    │  └──────────┘  └──────────┘  └──────────┘  └──────────┘      │
    └──────────────────────────────────────────────────────────────┘
```

## Visual Graph Interface Mockup

```
┌─────────────────────────────────────────────────────────────────────────┐
│ Grafity Graph Explorer                                    [─][□][X]    │
├─────────────────────────────────────────────────────────────────────────┤
│ File  Edit  View  Graph  Tools  Help                                   │
├────────┬────────────────────────────────────────────────────┬──────────┤
│        │                                                    │ FILTERS  │
│ LAYERS │              GRAPH CANVAS                         ├──────────┤
│        │                                                    │□Business │
│[System]│     ┌──────┐        ┌──────┐                     │☑Code     │
│        │     │TodoApp├───────►│ API  │                     │☑Docs     │
│[Biz]   │     └───┬───┘        └──┬───┘                     │□Chat     │
│        │         │               │                          ├──────────┤
│[Comp]  │    ┌────▼────┐    ┌────▼────┐                    │ SEARCH   │
│        │    │TodoList │    │TodoItem │                    │[______]  │
│[Code]  │    └────┬────┘    └────┬────┘                    ├──────────┤
│        │         │               │                          │ DETAILS  │
│        │    ┌────▼────┐    ┌────▼────┐                    │          │
│        │    │addTodo()│    │toggle() │                    │Node:     │
│        │    └─────────┘    └─────────┘                    │TodoList  │
│        │                                                    │          │
│        │  [Zoom: 100%] [Nodes: 26] [Edges: 25]            │Type:     │
│        │                                                    │Component │
└────────┴────────────────────────────────────────────────────┴──────────┘
│ Ready | Connected to Claude Code | Graph: sample-react-app              │
└─────────────────────────────────────────────────────────────────────────┘
```

## CLI Integration Flow

```
$ nx graph --json | claude -p "analyze architecture" --output-format json

     ┌─────────┐         ┌─────────┐         ┌─────────┐         ┌─────────┐
     │   Nx    │  JSON   │ Claude  │  AI     │  Graph  │  Visual │  User   │
     │  Graph  ├────────►│  Code   ├────────►│ Builder ├────────►│   UI    │
     └─────────┘         └─────────┘         └─────────┘         └─────────┘
         ▲                    │                    │                    ▼
         │                    │                    │                    │
    ┌─────────┐               │               ┌─────────┐         ┌─────────┐
    │  Code   │◄──────────────┴───────────────│Feedback │◄────────│ Actions │
    └─────────┘                               └─────────┘         └─────────┘

COMMANDS:
────────
claude analyze ./src --json           # Analyze source code
nx graph | claude -p "find patterns"  # Find architectural patterns
claude chat --graph                   # Start graph-based conversation
claude generate --from-graph graph.json # Generate code from graph
```

## The Vision: Knowledge-Code Continuum

```
     ╔═══════════════════════════════════════════════════════════════╗
     ║                    THE KNOWLEDGE-CODE CONTINUUM                ║
     ╚═══════════════════════════════════════════════════════════════╝

        IDEAS                GRAPHS              CODE              INSIGHTS
         │                     │                  │                   │
         ▼                     ▼                  ▼                   ▼
    ┌─────────┐          ┌─────────┐       ┌─────────┐        ┌─────────┐
    │Business │          │  Graph  │       │  Actual │        │Pattern  │
    │Concepts │─────────►│  Nodes  │──────►│  Code   │───────►│Discovery│
    └─────────┘          └─────────┘       └─────────┘        └─────────┘
         ▲                     ▲                  ▲                   │
         │                     │                  │                   │
         └─────────────────────┴──────────────────┴───────────────────┘
                            CONTINUOUS FEEDBACK LOOP

    Every conversation, every line of code, every document becomes a
    living node in an ever-evolving graph of knowledge and implementation.
```